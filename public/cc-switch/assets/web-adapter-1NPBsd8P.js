const _="/api/config",i="/api/cc-switch";async function p(t,e){console.log(`[Web Adapter] invoke command: ${t}`,e);const c=d(t,e);console.log("[Web Adapter] endpoint:",c);try{if(c.url==="__mock__")switch(console.log(`[Web Adapter] Returning mock data for ${t}`),t){case"check_env_conflicts":return[];case"check_for_updates":return;case"get_version":return"3.8.2-web";case"is_portable_mode":case"is_proxy_running":case"is_live_takeover_active":return!1;case"get_config_dir":case"get_claude_code_config_path":case"get_app_config_path":return"/mock/path";case"get_app_config_dir_override":return null;case"set_app_config_dir_override":case"apply_claude_plugin_config":case"sync_current_providers_live":case"restart_app":case"stop_proxy_with_restore":case"import_default_config":return!0;case"get_proxy_status":return{running:!1,port:0,address:"127.0.0.1"};case"start_proxy_with_takeover":return{port:3e3,address:"127.0.0.1"};case"switch_proxy_provider":return;default:return{}}const n=await fetch(c.url,{method:c.method,headers:{"Content-Type":"application/json"},body:c.body?JSON.stringify(c.body):void 0});if(!n.ok)throw console.error(`[Web Adapter] HTTP error! status: ${n.status}`),new Error(`HTTP error! status: ${n.status}`);const r=await n.json();if(console.log(`[Web Adapter] result for ${t}:`,r),r.success&&r.data!==void 0)switch(t){case"get_providers":if(console.log("[Web Adapter] get_providers result.data:",r.data),console.log("[Web Adapter] has providers?",!!r.data.providers),r.data.providers){console.log("[Web Adapter] providers array length:",r.data.providers.length);const a={};return r.data.providers.forEach(o=>{console.log("[Web Adapter] Processing provider:",o.id,o.name),a[o.id]={id:o.id,name:o.name,settingsConfig:o.settings_config||{},createdAt:o.created_at||Date.now(),sortIndex:o.sort_index||0,category:o.category,icon:o.icon,iconColor:o.icon_color,websiteUrl:o.website_url,notes:o.notes,meta:o.meta||{}}}),console.log("[Web Adapter] Final providersMap:",a),console.log("[Web Adapter] Providers loaded:",Object.keys(a).length),a}return console.log("[Web Adapter] No providers array, returning result.data:",r.data),r.data;case"get_current_provider":return r.data.current;default:return r.data}return r}catch(n){throw console.error(`Failed to invoke ${t}:`,n),n}}async function s(t,e){return console.log(`[Web Adapter] Listening to event: ${t}`),()=>{console.log(`[Web Adapter] Unlistened from event: ${t}`)}}function d(t,e){var c;switch(e!=null&&e.app,t){case"get_providers":return{url:`${i}/providers?app=${(e==null?void 0:e.app)||"claude"}`,method:"GET"};case"get_current_provider":return{url:`${i}/current?app=${(e==null?void 0:e.app)||"claude"}`,method:"GET"};case"add_provider":return{url:`${i}/add`,method:"POST",body:{provider:e==null?void 0:e.provider,app:(e==null?void 0:e.app)||"claude"}};case"update_provider":return{url:`${i}/update/${(c=e==null?void 0:e.provider)==null?void 0:c.id}`,method:"PUT",body:{provider:e==null?void 0:e.provider,app:(e==null?void 0:e.app)||"claude"}};case"delete_provider":return{url:`${i}/delete/${e==null?void 0:e.id}?app=${(e==null?void 0:e.app)||"claude"}`,method:"DELETE"};case"switch_provider":return{url:`${i}/switch`,method:"POST",body:{provider_id:e==null?void 0:e.id,app:(e==null?void 0:e.app)||"claude"}};case"get_settings":return{url:`${_}/settings`,method:"GET"};case"save_settings":return{url:`${_}/settings`,method:"PUT",body:e==null?void 0:e.settings};case"get_templates":return{url:`${_}/templates`,method:"GET"};case"health_check":return{url:`${_}/health`,method:"GET"};case"check_env_conflicts":case"check_for_updates":case"get_version":case"is_portable_mode":case"get_config_dir":case"open_config_folder":case"pick_directory":case"get_claude_code_config_path":case"get_app_config_path":case"open_app_config_folder":case"get_app_config_dir_override":case"set_app_config_dir_override":case"apply_claude_plugin_config":case"save_file_dialog":case"open_file_dialog":case"export_config_to_file":case"import_config_from_file":case"import_default_config":case"sync_current_providers_live":case"restart_app":case"get_proxy_status":case"is_proxy_running":case"is_live_takeover_active":case"start_proxy_with_takeover":case"stop_proxy_with_restore":case"switch_proxy_provider":return console.warn(`[Web Adapter] Command not supported in web mode: ${t}`),{url:"__mock__",method:"GET"};default:return console.warn(`[Web Adapter] Unknown command: ${t}`),{url:"__mock__",method:"GET"}}}export{p as invoke,s as listen};

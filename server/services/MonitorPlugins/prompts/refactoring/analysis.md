# 重构优化 - 问题分析阶段

## 阶段目标
识别代码中的问题，确定重构范围和优先级。

## 代码异味识别

### 常见代码异味
| 类型 | 描述 | 解决方案 |
|------|------|----------|
| 重复代码 | 相同或相似的代码出现多次 | 提取方法/类 |
| 过长方法 | 方法超过 20-30 行 | 拆分方法 |
| 过大类 | 类承担过多职责 | 拆分类 |
| 过长参数列表 | 方法参数超过 3-4 个 | 引入参数对象 |
| 发散式变化 | 一个类因多种原因修改 | 拆分类 |
| 霰弹式修改 | 一个变化影响多个类 | 合并相关代码 |
| 依恋情结 | 方法过度使用其他类的数据 | 移动方法 |
| 数据泥团 | 多个数据项总是一起出现 | 提取类 |

### 复杂度分析
```javascript
// 圈复杂度计算
// 每个 if/else/for/while/case/catch 增加 1
// 目标：保持在 10 以下

// 认知复杂度
// 考虑嵌套深度和控制流
// 目标：保持在 15 以下
```

## 分析工具

### 静态分析
- ESLint / TSLint
- SonarQube
- CodeClimate
- Complexity Report

### 依赖分析
- Dependency Cruiser
- Madge
- npm-check

## 分析清单

- [ ] 识别重复代码
- [ ] 检查方法长度
- [ ] 检查类大小
- [ ] 分析圈复杂度
- [ ] 检查依赖关系
- [ ] 识别技术债务
